

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>histomicstk.features &mdash; HistomicsTK  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="histomicstk.annotations_and_masks" href="histomicstk.annotations_and_masks.html" />
    <link rel="prev" title="histomicstk.segmentation.positive_pixel_count" href="histomicstk.segmentation.positive_pixel_count.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            HistomicsTK
              <img src="_static/histomicstk_mark.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api-docs.html">API Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="histomicstk.html">histomicstk</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="histomicstk.utils.html">utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="histomicstk.preprocessing.html">preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="histomicstk.filters.html">filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="histomicstk.segmentation.html">segmentation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#histomicstk.features.compute_fsd_features"><code class="docutils literal notranslate"><span class="pre">compute_fsd_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#histomicstk.features.compute_global_cell_graph_features"><code class="docutils literal notranslate"><span class="pre">compute_global_cell_graph_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#histomicstk.features.compute_gradient_features"><code class="docutils literal notranslate"><span class="pre">compute_gradient_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#histomicstk.features.compute_haralick_features"><code class="docutils literal notranslate"><span class="pre">compute_haralick_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#histomicstk.features.compute_intensity_features"><code class="docutils literal notranslate"><span class="pre">compute_intensity_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#histomicstk.features.compute_morphometry_features"><code class="docutils literal notranslate"><span class="pre">compute_morphometry_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#histomicstk.features.compute_nuclei_features"><code class="docutils literal notranslate"><span class="pre">compute_nuclei_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#histomicstk.features.graycomatrixext"><code class="docutils literal notranslate"><span class="pre">graycomatrixext()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="histomicstk.annotations_and_masks.html">annotations and masks</a></li>
<li class="toctree-l3"><a class="reference internal" href="histomicstk.saliency.html">saliency (tissue/cellularity detection)</a></li>
<li class="toctree-l3"><a class="reference internal" href="histomicstk.workflows.html">workflows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">HistomicsTK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api-docs.html">API Documentation</a></li>
          <li class="breadcrumb-item"><a href="histomicstk.html">histomicstk</a></li>
      <li class="breadcrumb-item active">histomicstk.features</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/histomicstk.features.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-histomicstk.features">
<span id="histomicstk-features"></span><h1>histomicstk.features<a class="headerlink" href="#module-histomicstk.features" title="Link to this heading">¶</a></h1>
<p>This package contains functions to computing a variety of image-based features
that quantify the appearance and/or morphology of an objects/regions in the
image. These are needed for classifying objects (e.g. nuclei) and
regions (e.g. tissues) found in histopathology images.</p>
<dl class="py function">
<dt class="sig sig-object py" id="histomicstk.features.compute_fsd_features">
<span class="sig-prename descclassname"><span class="pre">histomicstk.features.</span></span><span class="sig-name descname"><span class="pre">compute_fsd_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rprops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/histomicstk/features/compute_fsd_features.html#compute_fsd_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#histomicstk.features.compute_fsd_features" title="Link to this definition">¶</a></dt>
<dd><p>Calculates <cite>Fourier shape descriptors</cite> for each objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_label</strong> (<em>array_like</em>) – A labeled mask image wherein intensity of a pixel is the ID of the
object it belongs to. Non-zero values are considered to be foreground
objects.</p></li>
<li><p><strong>K</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Number of points for boundary resampling to calculate fourier
descriptors. Default value = 128.</p></li>
<li><p><strong>Fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Number of frequency bins for calculating FSDs. Default value = 6.</p></li>
<li><p><strong>Delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Used to dilate nuclei and define cytoplasm region. Default value = 8.</p></li>
<li><p><strong>rprops</strong> (<em>output</em><em> of </em><em>skimage.measure.regionprops</em><em>, </em><em>optional</em>) – rprops = skimage.measure.regionprops( im_label ). If rprops is not
passed then it will be computed inside which will increase the
computation time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fdata</strong> – object/label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pandas data frame containing the FSD features for each</p>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>D. Zhang et al. “A comparative study on shape retrieval using
Fourier descriptors with different shape signatures,” In Proc.
ICIMADE01, 2001.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="histomicstk.features.compute_global_cell_graph_features">
<span class="sig-prename descclassname"><span class="pre">histomicstk.features.</span></span><span class="sig-name descname"><span class="pre">compute_global_cell_graph_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centroids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_distances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">5,</span> <span class="pre">7)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/histomicstk/features/compute_global_cell_graph_features.html#compute_global_cell_graph_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#histomicstk.features.compute_global_cell_graph_features" title="Link to this definition">¶</a></dt>
<dd><p>Compute global (i.e., not per-nucleus) features of the nuclei with
the given centroids based on the partitioning of the space into
Voronoi cells and on the induced graph structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>centroids</strong> (<em>array_like</em>) – Nx2 numpy array of nuclear centroids</p></li>
<li><p><strong>neighbor_distances</strong> (<em>array_like</em>) – Radii to count neighbors in</p></li>
<li><p><strong>neighbor_counts</strong> (<em>sequence</em>) – Sequence of numbers of neighbors, each of which is used to
compute statistics relating to the distance required to reach
that many neighbors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>props</strong> – A single-row DataFrame with the following columns:</p>
<ul class="simple">
<li><p>voronoi_…: Voronoi diagram features</p>
<ul>
<li><p>area_…: Polygon area features</p></li>
<li><p>peri_…: Polygon perimeter features</p></li>
<li><p>max_dist_…: Maximum distance in polygon features</p></li>
</ul>
</li>
<li><p>delaunay_…: Delaunay triangulation features</p>
<ul>
<li><p>sides_…: Triangle side length features</p></li>
<li><p>area_…: Triangle area features</p></li>
</ul>
</li>
<li><p>mst_branches_…: Minimum spanning tree branch features</p></li>
<li><p>density_…: Density features</p>
<ul>
<li><p>neighbors_in_distance_…</p>
<ul>
<li><p>0, 1, …, len(neighbor_distances) - 1: Neighbor count
within given radius features.</p></li>
</ul>
</li>
<li><p>distance_for_neighbors_…</p>
<ul>
<li><p>0, 1, …, len(neighbor_counts) - 1: Minimum distance to
enclose count neighbors features</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The “…”s are meant to signify that what precedes is the
start of a column name.  At the end of each column name is one
of ‘mean’, ‘stddev’, ‘min_max_ratio’, and ‘disorder’.
‘min_max_ratio’ is the minimum-to-maximum ratio, and disorder
is stddev / (mean + stddev).</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The indices for the density features are with respect to the
<em>sorted</em> values of the corresponding argument sequence.</p>
</div>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Doyle, S., Agner, S., Madabhushi, A., Feldman, M., &amp; Tomaszewski, J.
(2008, May).  Automated grading of breast cancer histopathology using
spectral clustering with textural and architectural image features.
In Biomedical Imaging: From Nano to Macro, 2008.  ISBI 2008.
5th IEEE International Symposium on (pp. 496-499).  IEEE.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="histomicstk.features.compute_gradient_features">
<span class="sig-prename descclassname"><span class="pre">histomicstk.features.</span></span><span class="sig-name descname"><span class="pre">compute_gradient_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_intensity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hist_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rprops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/histomicstk/features/compute_gradient_features.html#compute_gradient_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#histomicstk.features.compute_gradient_features" title="Link to this definition">¶</a></dt>
<dd><p>Calculates gradient features from an intensity image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_label</strong> (<em>array_like</em>) – A labeled mask image wherein intensity of a pixel is the ID of the
object it belongs to. Non-zero values are considered to be foreground
objects.</p></li>
<li><p><strong>im_intensity</strong> (<em>array_like</em>) – Intensity image</p></li>
<li><p><strong>num_hist_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Number of bins used to computed the gradient histogram of an object.
Histogram is used to energy and entropy features. Default is 10.</p></li>
<li><p><strong>rprops</strong> (<em>output</em><em> of </em><em>skimage.measure.regionprops</em><em>, </em><em>optional</em>) – rprops = skimage.measure.regionprops( im_label ). If rprops is not
passed then it will be computed inside which will increase the
computation time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fdata</strong> – A pandas dataframe containing the gradient features listed below for
each object/label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>List of gradient features computed by this function:</p>
<dl class="simple">
<dt>Gradient.Mag.Mean<span class="classifier">float</span></dt><dd><p>Mean of gradient data.</p>
</dd>
<dt>Gradient.Mag.Std<span class="classifier">float</span></dt><dd><p>Standard deviation of gradient data.</p>
</dd>
<dt>Gradient.Mag.Skewness<span class="classifier">float</span></dt><dd><p>Skewness of gradient data. Value is 0 when all values are equal.</p>
</dd>
<dt>Gradient.Mag.Kurtosis<span class="classifier">float</span></dt><dd><p>Kurtosis of gradient data. Value is -3 when all values are equal.</p>
</dd>
<dt>Gradient.Mag.HistEnergy<span class="classifier">float</span></dt><dd><p>Energy of the gradient magnitude histogram of object pixels</p>
</dd>
<dt>Gradient.Mag.HistEnergy<span class="classifier">float</span></dt><dd><p>Entropy of the gradient magnitude histogram of object pixels.</p>
</dd>
<dt>Gradient.Canny.Sum<span class="classifier">float</span></dt><dd><p>Sum of canny filtered gradient data.</p>
</dd>
<dt>Gradient.Canny.Mean<span class="classifier">float</span></dt><dd><p>Mean of canny filtered gradient data.</p>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>Daniel Zwillinger and Stephen Kokoska. “CRC standard probability
and statistics tables and formulae,” Crc Press, 1999.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="histomicstk.features.compute_haralick_features">
<span class="sig-prename descclassname"><span class="pre">histomicstk.features.</span></span><span class="sig-name descname"><span class="pre">compute_haralick_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_intensity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gray_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rprops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/histomicstk/features/compute_haralick_features.html#compute_haralick_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#histomicstk.features.compute_haralick_features" title="Link to this definition">¶</a></dt>
<dd><p>Calculates 26 Haralick texture features for each object in the given label
mask.</p>
<p>These features are derived from gray-level co-occurence matrix (GLCM)
that is a two dimensional histogram containing the counts/probabilities of
co-occurring intensity values with a given neighborhood offset in the
region occupied by an object in the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_label</strong> (<em>array_like</em>) – An ND labeled mask image wherein intensity of a pixel is the ID of the
object it belongs to. Non-zero values are considered to be foreground
objects.</p></li>
<li><p><strong>im_intensity</strong> (<em>array_like</em>) – An ND single channel intensity image.</p></li>
<li><p><strong>offsets</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>A (num_offsets, num_image_dims) array of offset vectors
specifying the distance between the pixel-of-interest and
its neighbor. Note that the first dimension corresponds to
the rows.</p>
<p>See <cite>histomicstk.features.graycomatrixext</cite> for more details.</p>
</p></li>
<li><p><strong>num_levels</strong> (<em>unsigned int</em><em>, </em><em>optional</em>) – <p>An integer specifying the number of gray levels For example, if
<cite>NumLevels</cite> is 8,  the intensity values of the input image are
scaled so they are integers between 1 and 8.  The number of gray
levels determines the size of the gray-level co-occurrence matrix.</p>
<p>Default: 2 for binary/logical image, 32 for numeric image</p>
</p></li>
<li><p><strong>gray_limits</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>A two-element array specifying the desired input intensity range.
Intensity values in the input image will be clipped into this range.</p>
<p>Default: [0, 1] for boolean-valued image, [0, 255] for integer-valued
image, and [0.0, 1.0] for-real valued image</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fdata</strong> – A pandas dataframe containing the haralick features.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function computes the following list of haralick features derived
from normalized GLCMs (P) of the given list of neighborhood offsets:</p>
<dl>
<dt>Haralick.ASM.Mean, Haralick.ASM.Range<span class="classifier">float</span></dt><dd><p>Mean and range of the angular second moment (ASM) feature for GLCMs
of all offsets. It is a measure of image homogeneity and is computed
as follows:</p>
<div class="math notranslate nohighlight">
\[ASM = \sum_{i,j=0}^{levels-1} p(i,j)^2\]</div>
</dd>
<dt>Haralick.Contrast.Mean, Haralick.Contrast.Range<span class="classifier">float</span></dt><dd><p>Mean and range of the Contrast feature for GLCMs of all offsets. It is
a measure of the amount of variation between intensities of
neighboiring pixels. It is equal to zero for a constant image and
increases as the amount of variation increases. It is computed as
follows:</p>
<div class="math notranslate nohighlight">
\[Contrast = \sum_{i,j=0}^{levels-1}  (i-j)^2 p(i,j)\]</div>
</dd>
<dt>Haralick.Correlation.Mean, Haralick.Correlation.Range<span class="classifier">float</span></dt><dd><p>Mean and range of the Correlation feature for GLCMs of all offsets. It
is a measure of correlation between the intensity values of
neighboring pixels. It is computed as follows:</p>
<div class="math notranslate nohighlight">
\[Correlation =
\sum_{i,j=0}^{levels-1} p(i,j)\left[\frac{(i-\mu_i)
(j-\mu_j)}{\sigma_i \sigma_j}\right]\]</div>
</dd>
<dt>Haralick.SumOfSquares.Mean, Haralick.SumOfSquares.Range<span class="classifier">float</span></dt><dd><p>Mean and range of the SumOfSquares feature for GLCMs of all offsets.
It is a measure of variance and is computed as follows:</p>
<div class="math notranslate nohighlight">
\[SumofSquare =
\sum_{i,j=0}^{levels-1} (i - \mu)^2 p(i,j)\]</div>
</dd>
<dt>Haralick.IDM.Mean, Haralick.IDM.Range<span class="classifier">float</span></dt><dd><p>Mean and range of the inverse difference moment (IDM) feature for
GLCMS of all offsets. It is a measure of homogeneity and is computed
as follows:</p>
<div class="math notranslate nohighlight">
\[IDM = \sum_{i,j=0}^{levels-1} \frac{1}{1 + (i - j)^2} p(i,j)\]</div>
</dd>
<dt>Haralick.SumAverage.Mean, Haralick.SumAverage.Range<span class="classifier">float</span></dt><dd><p>Mean and range of sum average feature for GLCMs of all offsets.
It is computed as follows:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}SumAverage = \sum_{k=2}^{2 levels} k p_{x+y}(k), \qquad where \\\end{split}\\\begin{split}p_{x+y}(k) =
\sum_{i,j=0}^{levels-1} \delta_{i+j, k} p(i,j) \\\end{split}\\\begin{split}\delta_{m,n} = \left\{
\begin{array}{11}
    1 &amp; {\rm when ~} m=n \\
    0 &amp; {\rm when ~} m \ne n
\end{array}
\right.\end{split}\end{aligned}\end{align} \]</div>
</dd>
<dt>Haralick.SumVariance.Mean, Haralick.SumVariance.Range<span class="classifier">float</span></dt><dd><p>Mean and range of sum variance feature for the GLCMS of all offsets.
It is computed as follows:</p>
<div class="math notranslate nohighlight">
\[SumVariance =
\sum_{k=2}^{2 levels} (k - SumEntropy) p_{x+y}(k)\]</div>
</dd>
<dt>Haralick.SumEntropy.Mean, Haralick.SumEntropy.Range<span class="classifier">float</span></dt><dd><p>Mean and range of the sum entropy features for GLCMS of all offsets.
It is computed as follows:</p>
<div class="math notranslate nohighlight">
\[SumEntropy =
- \sum_{k=2}^{2 levels} p_{x+y}(k) \log(p_{x+y}(k))\]</div>
</dd>
<dt>Haralick.Entropy.Mean, Haralick.Entropy.Range<span class="classifier">float</span></dt><dd><p>Mean and range of the entropy features for GLCMs of all offsets.
It is computed as follows:</p>
<div class="math notranslate nohighlight">
\[Entropy = - \sum_{i,j=0}^{levels-1} p(i,j) \log(p(i,j))\]</div>
</dd>
<dt>Haralick.DifferenceVariance.Mean, Haralick.DifferenceVariance.Range<span class="classifier">float</span></dt><dd><p>Mean and Range of the difference variance feature of GLCMs of all
offsets. It is computed as follows:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}DifferenceVariance = {\rm variance \ of ~} p_{x-y}, \qquad where \\\end{split}\\p_{x-y}(k) =
\sum_{i,j=0}^{levels-1} \delta_{|i-j|, k} p(i,j)\end{aligned}\end{align} \]</div>
</dd>
<dt>Haralick.DifferenceEntropy.Mean, Haralick.DifferenceEntropy.Range<span class="classifier">float</span></dt><dd><p>Mean and range of the difference entropy feature for GLCMS of all
offsets. It is computed as follows:</p>
<div class="math notranslate nohighlight">
\[DifferenceEntropy = {\rm entropy \ of ~} p_{x-y}\]</div>
</dd>
<dt>Haralick.IMC1.Mean, Haralick.IMC1.Range<span class="classifier">float</span></dt><dd><p>Mean and range of the first information measure of correlation
feature for GLCMs of all offsets. It is computed as follows:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}IMC1 = \frac{HXY - HXY1}{\max(HX,HY)}, \qquad where \\\end{split}\\\begin{split}HXY = -\sum_{i,j=0}^{levels-1} p(i,j) \log(p(i,j)) \\\end{split}\\\begin{split}HXY1 = -\sum_{i,j=0}^{levels-1} p(i,j) \log(p_x(i) p_y(j)) \\\end{split}\\\begin{split}HX = -\sum_{i=0}^{levels-1} p_x(i) \log(p_x(i))    \\\end{split}\\\begin{split}HY = -\sum_{j=0}^{levels-1} p_y(j) \log(p_y(j))    \\\end{split}\\\begin{split}p_x(i) = \sum_{j=1}^{levels} p(i,j) \\\end{split}\\p_y(j) = \sum_{j=1}^{levels} p(i,j)\end{aligned}\end{align} \]</div>
</dd>
<dt>Haralick.IMC2.Mean, Haralick.IMC2.Range<span class="classifier">float</span></dt><dd><p>Mean and range of the second information measure of correlation
feature for GLCMs of all offsets. It is computed as follows:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}IMC2 = [1 - \exp(-2(HXY2 - HXY))]^{1/2}, \qquad where \\\end{split}\\HXY2 = -\sum_{i,j=0}^{levels-1} p_x(i) p_y(j) \log(p_x(i) p_y(j))\end{aligned}\end{align} \]</div>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></span>
<p>Haralick, et al. “Textural features for image classification,”
IEEE Transactions on Systems, Man, and Cybernatics, vol. 6,
pp: 610-621, 1973.</p>
</aside>
<aside class="footnote brackets" id="id5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></span>
<p>Luis Pedro Coelho. “Mahotas: Open source software for scriptable
computer vision,” Journal of Open Research Software, vol 1, 2013.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="histomicstk.features.compute_intensity_features">
<span class="sig-prename descclassname"><span class="pre">histomicstk.features.</span></span><span class="sig-name descname"><span class="pre">compute_intensity_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_intensity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hist_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rprops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/histomicstk/features/compute_intensity_features.html#compute_intensity_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#histomicstk.features.compute_intensity_features" title="Link to this definition">¶</a></dt>
<dd><p>Calculate intensity features from an intensity image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_label</strong> (<em>array_like</em>) – A labeled mask image wherein intensity of a pixel is the ID of the
object it belongs to. Non-zero values are considered to be foreground
objects.</p></li>
<li><p><strong>im_intensity</strong> (<em>array_like</em>) – Intensity image.</p></li>
<li><p><strong>num_hist_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Number of bins used to computed the intensity histogram of an object.
Histogram is used to energy and entropy features. Default is 10.</p></li>
<li><p><strong>rprops</strong> (<em>output</em><em> of </em><em>skimage.measure.regionprops</em><em>, </em><em>optional</em>) – rprops = skimage.measure.regionprops( im_label ). If rprops is not
passed then it will be computed inside which will increase the
computation time.</p></li>
<li><p><strong>feature_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>, </em><em>default is None</em>) – list of intensity features to return.
If none, all intensity features are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fdata</strong> – A pandas dataframe containing the intensity features listed below for
each object/label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>List of intensity features computed by this function:</p>
<dl class="simple">
<dt>Intensity.Min<span class="classifier">float</span></dt><dd><p>Minimum intensity of object pixels.</p>
</dd>
<dt>Intensity.Max<span class="classifier">float</span></dt><dd><p>Maximum intensity of object pixels.</p>
</dd>
<dt>Intensity.Mean<span class="classifier">float</span></dt><dd><p>Mean intensity of object pixels</p>
</dd>
<dt>Intensity.Median<span class="classifier">float</span></dt><dd><p>Median intensity of object pixels</p>
</dd>
<dt>Intensity.MeanMedianDiff<span class="classifier">float</span></dt><dd><p>Difference between mean and median intensities of object pixels.</p>
</dd>
<dt>Intensity.Std<span class="classifier">float</span></dt><dd><p>Standard deviation of the intensities of object pixels</p>
</dd>
<dt>Intensity.IQR: float</dt><dd><p>Inter-quartile range of the intensities of object pixels</p>
</dd>
<dt>Intensity.MAD: float</dt><dd><p>Median absolute deviation of the intensities of object pixels</p>
</dd>
<dt>Intensity.Skewness<span class="classifier">float</span></dt><dd><p>Skewness of the intensities of object pixels. Value is 0 when all
intensity values are equal.</p>
</dd>
<dt>Intensity.Kurtosis<span class="classifier">float</span></dt><dd><p>Kurtosis of the intensities of object pixels. Value is -3 when all
values are equal.</p>
</dd>
<dt>Intensity.HistEnergy<span class="classifier">float</span></dt><dd><p>Energy of the intensity histogram of object pixels</p>
</dd>
<dt>Intensity.HistEntropy<span class="classifier">float</span></dt><dd><p>Entropy of the intensity histogram of object pixels.</p>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></span>
<p>Daniel Zwillinger and Stephen Kokoska. “CRC standard probability
and statistics tables and formulae,” Crc Press, 1999.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="histomicstk.features.compute_morphometry_features">
<span class="sig-prename descclassname"><span class="pre">histomicstk.features.</span></span><span class="sig-name descname"><span class="pre">compute_morphometry_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rprops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/histomicstk/features/compute_morphometry_features.html#compute_morphometry_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#histomicstk.features.compute_morphometry_features" title="Link to this definition">¶</a></dt>
<dd><p>Calculate morphometry features for each object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_label</strong> (<em>array_like</em>) – A labeled mask image wherein intensity of a pixel is the ID of the
object it belongs to. Non-zero values are considered to be foreground
objects.</p></li>
<li><p><strong>rprops</strong> (<em>output</em><em> of </em><em>skimage.measure.regionprops</em><em>, </em><em>optional</em>) – rprops = skimage.measure.regionprops( im_label ). If rprops is not
passed then it will be computed inside which will increase the
computation time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fdata</strong> – A pandas dataframe containing the morphometry features for each
object/label listed below.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>List of morphometry features computed by this function:</p>
<dl class="simple">
<dt>Orientation.Orientation<span class="classifier">float</span></dt><dd><p>Angle between the horizontal axis and the major axis of the ellipse
that has the same second moments as the region,
ranging from <cite>-pi/2</cite> to <cite>pi/2</cite> counter-clockwise.</p>
</dd>
<dt>Size.Area<span class="classifier">int</span></dt><dd><p>Number of pixels the object occupies.</p>
</dd>
<dt>Size.ConvexHullArea<span class="classifier">int</span></dt><dd><p>Number of pixels of convex hull image, which is the smallest convex
polygon that encloses the region.</p>
</dd>
<dt>Size.MajorAxisLength<span class="classifier">float</span></dt><dd><p>The length of the major axis of the ellipse that has the same
normalized second central moments as the object.</p>
</dd>
<dt>Size.MinorAxisLength<span class="classifier">float</span></dt><dd><p>The length of the minor axis of the ellipse that has the same
normalized second central moments as the region.</p>
</dd>
<dt>Size.Perimeter<span class="classifier">float</span></dt><dd><p>Perimeter of object which approximates the contour as a line
through the centers of border pixels using a 4-connectivity.</p>
</dd>
<dt>Shape.Circularity: float</dt><dd><p>A measure of how similar the shape of an object is to the circle</p>
</dd>
<dt>Shape.Eccentricity<span class="classifier">float</span></dt><dd><p>A measure of aspect ratio computed to be the eccentricity of the
ellipse that has the same second-moments as the object region.
Eccentricity of an ellipse is the ratio of the focal distance
(distance between focal points) over the major axis length. The value
is in the interval [0, 1). When it is 0, the ellipse becomes a circle.</p>
</dd>
<dt>Shape.EquivalentDiameter<span class="classifier">float</span></dt><dd><p>The diameter of a circle with the same area as the object.</p>
</dd>
<dt>Shape.Extent<span class="classifier">float</span></dt><dd><p>Ratio of area of the object to its axis-aligned bounding box.</p>
</dd>
<dt>Shape.FractalDimension<span class="classifier">float</span></dt><dd><p>Minkowski–Bouligand dimension, aka. the box-counting dimension. It
is a measure of boundary complexity. See
<a class="reference external" href="https://en.wikipedia.org/wiki/Minkowski%E2%80%93Bouligand_dimension">https://en.wikipedia.org/wiki/Minkowski%E2%80%93Bouligand_dimension</a></p>
</dd>
<dt>Shape.MinorMajorAxisRatio<span class="classifier">float</span></dt><dd><p>A measure of aspect ratio. Ratio of minor to major axis of the ellipse
that has the same second-moments as the object region</p>
</dd>
<dt>Shape.Solidity<span class="classifier">float</span></dt><dd><p>A measure of convexity computed as the ratio of the number of pixels
in the object to that of its convex hull.</p>
</dd>
<dt>Shape.HuMoments-k<span class="classifier">float</span></dt><dd><p>Where k ranges from 1-7 are the 7 Hu moments features. The first six
moments are translation, scale and rotation invariant, while the
seventh moment flips its sign if the shape is a mirror image.
See <a class="reference external" href="https://learnopencv.com/shape-matching-using-hu-moments-c-python/">https://learnopencv.com/shape-matching-using-hu-moments-c-python/</a></p>
</dd>
<dt>Shape.WeightedHuMoments-k<span class="classifier">float</span></dt><dd><p>Same as Hu moments, but instead of using the binary mask, using the
intensity image.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="histomicstk.features.compute_nuclei_features">
<span class="sig-prename descclassname"><span class="pre">histomicstk.features.</span></span><span class="sig-name descname"><span class="pre">compute_nuclei_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_nuclei</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_cytoplasm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsd_bnd_pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsd_freq_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cyto_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_glcm_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morphometry_features_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsd_features_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity_features_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_features_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">haralick_features_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_nuclei_seg_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_nuclei_annotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/histomicstk/features/compute_nuclei_features.html#compute_nuclei_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#histomicstk.features.compute_nuclei_features" title="Link to this definition">¶</a></dt>
<dd><p>Calculates features for nuclei classification</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_label</strong> (<em>array_like</em>) – A labeled mask image wherein intensity of a pixel is the ID of the
object it belongs to. Non-zero values are considered to be foreground
objects.</p></li>
<li><p><strong>im_nuclei</strong> (<em>array_like</em>) – Nucleus channel intensity image.</p></li>
<li><p><strong>im_cytoplasm</strong> (<em>array_like</em>) – Cytoplasm channel intensity image.</p></li>
<li><p><strong>fsd_bnd_pts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Number of points for boundary resampling to calculate fourier
descriptors. Default value = 128.</p></li>
<li><p><strong>fsd_freq_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Number of frequency bins for calculating FSDs. Default value = 6.</p></li>
<li><p><strong>cyto_width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Estimated width of the ring-like neighborhood region around each
nucleus to be considered as its cytoplasm. Default value = 8.</p></li>
<li><p><strong>num_glcm_levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – <p>An integer specifying the number of gray levels For example, if
<cite>NumLevels</cite> is 32,  the intensity values of the input image are
scaled so they are integers between 0 and 31.  The number of gray
levels determines the size of the gray-level co-occurrence matrix.</p>
<p>Default: 32</p>
</p></li>
<li><p><strong>morphometry_features_flag</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – A flag that can be used to specify whether or not to compute
morphometry (size and shape) features.
See histomicstk.features.compute_morphometry_features for more details.</p></li>
<li><p><strong>fsd_features_flag</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – A flag that can be used to specify whether or not to compute
Fouried shape descriptor (FSD) features.
See <cite>histomicstk.features.compute_fsd_features</cite> for more details.</p></li>
<li><p><strong>intensity_features_flag</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – A flag that can be used to specify whether or not to compute
intensity features from the nucleus and cytoplasm channels.
See <cite>histomicstk.features.compute_fsd_features</cite> for more details.</p></li>
<li><p><strong>gradient_features_flag</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – A flag that can be used to specify whether or not to compute
gradient/edge features from intensity and cytoplasm channels.
See <cite>histomicstk.features.compute_gradient_features</cite> for more details.</p></li>
<li><p><strong>haralick_features_flag</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – A flag that can be used to specify whether or not to compute
haralick features from intensity and cytoplasm channels.
See <cite>histomicstk.features.compute_haralick_features</cite> for more details.</p></li>
<li><p><strong>return_nuclei_annotation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Returns the nuclei annotation if kept True</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fdata</strong> (<em>pandas.DataFrame</em>) – A pandas data frame containing the features listed below for each
object/label</p></li>
<li><p><strong>nuclei_annot_list</strong> (<em>List</em>) – List containing the boundaries of segmented nuclei in the input image.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>List of features computed by this function</p>
<dl>
<dt>Identifier</dt><dd><p>Location of the nucleus and its code in the input labeled mask.
Columns are prefixed by <em>Identifier.</em>. These include …</p>
<p>Identifier.Label (int) - nucleus label in the input labeled mask</p>
<p>Identifier.Xmin (int) - Left bound</p>
<p>Identifier.Ymin (int) - Upper bound</p>
<p>Identifier.Xmax (int) - Right bound</p>
<p>Identifier.Ymax (int) - Lower bound</p>
<p>Identifier.CentroidX (float) - X centroid (columns)</p>
<p>Identifier.CentroidY (float) - Y centroid (rows)</p>
<p>Identifier.WeightedCentroidX (float) - intensity-weighted X centroid</p>
<p>Identifier.WeightedCentroidY (float) - intensity-weighted Y centroid</p>
</dd>
<dt>Morphometry (size, shape, and orientation) features of the nuclei</dt><dd><p>See histomicstk.features.compute_morphometry_features for more details.
Feature names prefixed by <em>Size.</em>, <em>Shape.</em>, or <em>Orientation.</em>.</p>
</dd>
<dt>Fourier shape descriptor features</dt><dd><p>See <cite>histomicstk.features.compute_fsd_features</cite> for more details.
Feature names are prefixed by <em>FSD</em>.</p>
</dd>
<dt>Intensity features for the nucleus and cytoplasm channels</dt><dd><p>See <cite>histomicstk.features.compute_fsd_features</cite> for more details.
Feature names are prefixed by <em>Nucleus.Intensity.</em> for nucleus features
and <em>Cytoplasm.Intensity.</em> for cytoplasm features.</p>
</dd>
<dt>Gradient/edge features for the nucleus and cytoplasm channels</dt><dd><p>See <cite>histomicstk.features.compute_gradient_features</cite> for more details.
Feature names are prefixed by <em>Nucleus.Gradient.</em> for nucleus features
and <em>Cytoplasm.Gradient.</em> for cytoplasm features.</p>
</dd>
<dt>Haralick features for the nucleus and cytoplasm channels</dt><dd><p>See <cite>histomicstk.features.compute_haralick_features</cite> for more details.
Feature names are prefixed by <em>Nucleus.Haralick.</em> for nucleus features
and <em>Cytoplasm.Haralick.</em> for cytoplasm features.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#histomicstk.features.compute_morphometry_features" title="histomicstk.features.compute_morphometry_features"><code class="xref py py-obj docutils literal notranslate"><span class="pre">histomicstk.features.compute_morphometry_features</span></code></a>, <a class="reference internal" href="#histomicstk.features.compute_fsd_features" title="histomicstk.features.compute_fsd_features"><code class="xref py py-obj docutils literal notranslate"><span class="pre">histomicstk.features.compute_fsd_features</span></code></a>, <a class="reference internal" href="#histomicstk.features.compute_intensity_features" title="histomicstk.features.compute_intensity_features"><code class="xref py py-obj docutils literal notranslate"><span class="pre">histomicstk.features.compute_intensity_features</span></code></a>, <a class="reference internal" href="#histomicstk.features.compute_gradient_features" title="histomicstk.features.compute_gradient_features"><code class="xref py py-obj docutils literal notranslate"><span class="pre">histomicstk.features.compute_gradient_features</span></code></a>, <a class="reference internal" href="#histomicstk.features.compute_haralick_features" title="histomicstk.features.compute_haralick_features"><code class="xref py py-obj docutils literal notranslate"><span class="pre">histomicstk.features.compute_haralick_features</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="histomicstk.features.graycomatrixext">
<span class="sig-prename descclassname"><span class="pre">histomicstk.features.</span></span><span class="sig-name descname"><span class="pre">graycomatrixext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im_roi_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gray_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/histomicstk/features/graycomatrixext.html#graycomatrixext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#histomicstk.features.graycomatrixext" title="Link to this definition">¶</a></dt>
<dd><p>Computes gray-level co-occurence matrix (GLCM) within a region of
interest (ROI) of an image. GLCM is a 2D histogram/matrix containing the
counts/probabilities of co-occuring intensity values at a given offset
within an ROI of an image.</p>
<p>Read the documentation to know the default values used for each of the
optional parameter in different scenarios.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_input</strong> (<em>array_like</em>) – Input single channel intensity image</p></li>
<li><p><strong>im_roi_mask</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>A binary mask specifying the region of interest within which
to compute the GLCM. If not specified GLCM is computed for the
the entire image.</p>
<p>Default: None</p>
</p></li>
<li><p><strong>offsets</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>A (num_offsets, num_image_dims) array of offset vectors
specifying the distance between the pixel-of-interest and
its neighbor. Note that the first dimension corresponds to
the rows.</p>
<p>Because this offset is often expressed as an angle, the
following table lists the offset values that specify common
angles for a 2D image, given the pixel distance D.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Angle (deg)</p></th>
<th class="head"><p>offset [y, x]</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>[0 D]</p></td>
</tr>
<tr class="row-odd"><td><p>45</p></td>
<td><p>[-D D]</p></td>
</tr>
<tr class="row-even"><td><p>90</p></td>
<td><p>[-D 0]</p></td>
</tr>
<tr class="row-odd"><td><p>135</p></td>
<td><p>[-D -D]</p></td>
</tr>
</tbody>
</table>
<p>Default
- 1D: np.array([1])
- 2D : numpy.array([ [1, 0], [0, 1], [1, 1], [1, -1] ])
- 3D and higher: numpy.identity(num_image_dims)</p>
</p></li>
<li><p><strong>num_levels</strong> (<em>unsigned int</em><em>, </em><em>optional</em>) – <p>An integer specifying the number of gray levels For example, if
<cite>NumLevels</cite> is 8,  the intensity values of the input image are
scaled so they are integers between 1 and 8.  The number of gray
levels determines the size of the gray-level co-occurrence matrix.</p>
<p>Default: 2 for binary/logical image, 32 for numeric image</p>
</p></li>
<li><p><strong>gray_limits</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>A two-element array specifying the desired input intensity range.
Intensity values in the input image will be clipped into this range.</p>
<p>Default: [0, 1] for boolean-valued image, [0, 255] for integer-valued
image, and [0.0, 1.0] for-real valued image</p>
</p></li>
<li><p><strong>symmetric</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – <p>A boolean value that specifies whether or not the ordering of values
in pixel pairs is considered while creating the GLCM matrix.</p>
<p>For example, if <cite>Symmetric</cite> is True, then while calculating the
number of times the value 1 is adjacent to the value 2, both
1,2 and 2,1 pairings are counted. GLCM created in this way is
symmetric across its diagonal.</p>
<p>Default: False</p>
</p></li>
<li><p><strong>normed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – <p>A boolean value specifying whether or not to normalize glcm.</p>
<p>Default: False</p>
</p></li>
<li><p><strong>exclude_boundary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – <p>Specifies whether or not to exclude a pixel-pair if the
neighboring pixel in the pair is outside <cite>im_roi_mask</cite>.
Has an effect only when <cite>im_roi_mask</cite> is specified.</p>
<p>Default: False</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>glcm</strong> – num_levels x num_levels x num_offsets array containing the GLCM
for each offset.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id7" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></span>
<p>Haralick, R.M., K. Shanmugan, and I. Dinstein, “Textural Features
for Image Classification”, IEEE Transactions on Systems, Man, and
Cybernetics, Vol. SMC-3, 1973, pp. 610-621.</p>
</aside>
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></span>
<p>Haralick, R.M., and L.G. Shapiro. Computer and Robot Vision:
Vol. 1, Addison-Wesley, 1992, p. 459.</p>
</aside>
</aside>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="histomicstk.segmentation.positive_pixel_count.html" class="btn btn-neutral float-left" title="histomicstk.segmentation.positive_pixel_count" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="histomicstk.annotations_and_masks.html" class="btn btn-neutral float-right" title="histomicstk.annotations_and_masks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Kitware, Inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>